<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

    <title>Docker Maven Plugin</title>

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/serif.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
        <style type="text/css">
            img {border-style: none !important}
        </style>
	</head>

	<body>

   	<div class="reveal">
<div class="slides">
    <section>
        <h1>Docker Maven Plugin</h1>
        <h2>By Alex Collins</h2>
    </section>
    <section>
        <h2>Overview</h2>
        <ol>
            <li>Who am I?</li>
            <li>Motivations for writing a plugin.</li>
            <li>Architecture of the plugin.</li>
            <li>The main course: demos.</li>
        </ol>
    </section>
    <section>
        <h2>Who Am I?</h2>
        <ul>
            <li>Java Server Techincal Lead Of Game Studio Gamesys.</li>
            <li>12 Years Of Enterprise Application Development Experience.</li>
            <li>Co-author of Selenium WebDriver In Practice.</li>
            <li>Test lover.</li>
        </ul>
    </section>
    <section>
        <section>
            <h2>Docker VirtualBox Plugin</h2>
        </section>
        <section>
            <h3>Goal</h3>
            <p>Build and test an application on a VirtualBox starting from nothing.</p>
        </section>
        <section>
            <h3>Problems</h3>
            <ul>
                <li>I had to build VirtualBox base images.</li>
                <li>Verbose XML driven syntax.</li>
                <li>Masses of file I/O.</li>
                <li>Slow as to be unusable.</li>
            </ul>
        </section>
        <section>
            <h2>The Uber-WAR That Would Not Deploy</h2>

            <img src="images/docker-maven-plugin/eat-everything.jpg"/>
        </section>
        <section>
            <h3>Oh Uber-WAR - What Problems You Cause!</h3>
            <ul>
                <li>Dozens Of Developers Committing To A Large Tree Of Dependencies.</li>
                <li>Regularly Broken.</li>
                <li>Automatically Or Manually Deployed.</li>
                <li>Angry QAs.</li>
                <li>Nightly Test Suite Often Red (no feedback).</li>
            </ul>
        </section>
        <section>
            <h3>Solution?</h3>
            <ul>
                <li>Smoke test on the CI - bad WAR cannot get into the wild.</li>
                <li>Send an IM notifcation to the the culprit.</li>
                <li>QAs happy!</li>
                <li>Test suite green, or red for the right reason.</li>
            </ul>
        </section>
    </section>
    <section>
        <h1>March 2014</h1>
        <p>I want my Docker applications to be tested before they get into the repository.</p>
        <p>Must write a plugin to do so.</p>
    </section>
    <section>
        <h2>What Does The Plugin Do?</h2>
        <ol>
            <li>Allow you to run images as part of the Maven project lifecycle.</li>
            <li>Version control a project with the images it depends on.</li>
            <li>Build containers using project artifacts.</li>
            <li>Test those built containers before deploying.</li>
        </ol>
    </section>
    <section>
        <section><h1>Architecture</h1></section>
        <section>
            <h2>Layers</h2>
            <ol>
                <li>Thin Maven Plugin Glue.</li>
                <li>Orchestrating Engine.</li>
                <li>Docker API Client.</li>
            </ol>
        </section>
    </section>
    <section>
        <section><h1>Set-up</h1></section>
        <section>
            <h2>Maven <code>./pom.xml</code></h2>
            <pre><code><plugin>
    <groupId>com.alexecollins.docker</groupId>
    <artifactId>docker-maven-plugin</artifactId>
    <executions>
        <execution>
            <goals>
                <goal>clean</goal>
                <goal>start</goal>
                <goal>stop</goal>
                <goal>deploy</goal>
            </goals>
        </execution>
    </executions>
</plugin></code></pre>
        </section>
        <section>
            <h2><code>src/main/docker/app/Dockerfile</code></h2>
            <pre><code>FROM dockerfile/java:oracle-java7

EXPOSE 8080
EXPOSE 9200
EXPOSE 9300

ADD ${project.build.finalName}.jar .

CMD java  -jar /${project.build.finalName}.jar</code></pre>
        </section>
        <section>
            <h2><code>src/main/docker/app/conf.yml</code></h2>
            <pre><code>packaging:
  add:
    - target/${project.build.finalName}.jar
ports:
  - 8080
  - 9200
  - 9300
healthChecks:
  pings:
    - url: http://localhost:9200/
    - url: http://localhost:8080/
tag:
    alexec/searchinabox:${project.version}</code></pre>
        </section>
    </section>
    <section>
        <h2>Demo: ElasticSearch in a Box</h2>
        <p><a href="https://github.com/alexec/search-in-a-box">https://github.com/alexec/search-in-a-box</a></p>
        <p>Technologies: Docker, Maven, Java, Spring Boot, Elastic Search, JUnit, Selenium WebDriver</p>
    </section>
    <section>
        <h2>Demo: Selenium Grid</h2>
        <p><a href="https://github.com/alexec/selenium-visual-testing">https://github.com/alexec/selenium-visual-testing</a></p>
        <p>Technologies: Docker, Maven, Java, JUnit, Selenium Grid</p>
    </section>
    <section>
        <h2>What's Next?</h2>
        <ul>
            <li>Gradle, Ant, and SBT Versions</li>
            <li>Fig (aka Compose) Compatibility</li>
        </ul>
    </section>
    <section>
        <h1>Fin</h1>
        <p>
            <a href="http://www.alexecollins.com/tags/docker/">http://www.alexecollins.com/tags/docker</a>
            <a href="https://github.com/alexec">https://github.com/alexec/docker-maven-plugin</a>
        </p>
        <p><small>Presentation made with RevealJS</small></p>
    </section>
</div>
</div>


		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
